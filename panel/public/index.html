<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>XReality</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>

  <header>
    <div class="header-left">
      <h1>XReality</h1>
      <span class="badge version-badge">v26.2.6</span>
    </div>
    <div class="header-right">
      <div class="status-badge" id="status-badge">
        <span class="status-dot"></span>
        <span class="status-text">Checking...</span>
      </div>
    </div>
  </header>

  <div id="loading-state" class="state-card">
    <div class="spinner"></div>
    <p>Connecting to proxy...</p>
  </div>

  <div id="error-state" class="state-card hidden">
    <p class="error-icon">!</p>
    <p id="error-message">Proxy not initialized. Start the proxy container first.</p>
    <button class="btn btn-secondary" onclick="location.reload()">Retry</button>
  </div>

  <main id="dashboard" class="hidden">

    <div class="grid-2col">
    <!-- Connection Details -->
      <div class="card">
        <h2>Connection Details</h2>
        <div class="detail-list">
          <div class="detail-row">
            <span class="detail-label">Server</span>
            <div class="detail-value">
              <code id="val-server">-</code>
              <button class="copy-btn" data-target="val-server" title="Copy">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
              </button>
            </div>
          </div>
          <div class="detail-row">
            <span class="detail-label">UUID</span>
            <div class="detail-value">
              <code id="val-uuid">-</code>
              <button class="copy-btn" data-target="val-uuid" title="Copy">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
              </button>
            </div>
          </div>
          <div class="detail-row">
            <span class="detail-label">Public Key</span>
            <div class="detail-value">
              <code id="val-pubkey" class="truncate">-</code>
              <button class="copy-btn" data-target="val-pubkey" title="Copy">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
              </button>
            </div>
          </div>
          <div class="detail-row">
            <span class="detail-label">SNI</span>
            <div class="detail-value">
              <code id="val-sni">-</code>
              <button class="copy-btn" data-target="val-sni" title="Copy">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
              </button>
            </div>
          </div>
          <div class="detail-row">
            <span class="detail-label">Short ID</span>
            <div class="detail-value">
              <code id="val-sid">-</code>
              <button class="copy-btn" data-target="val-sid" title="Copy">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
              </button>
            </div>
          </div>
          <div class="detail-row">
            <span class="detail-label">Flow</span>
            <div class="detail-value"><code>xtls-rprx-vision</code></div>
          </div>
          <div class="detail-row">
            <span class="detail-label">Security</span>
            <div class="detail-value"><code>reality</code></div>
          </div>
          <div class="detail-row">
            <span class="detail-label">Fingerprint</span>
            <div class="detail-value"><code>chrome</code></div>
          </div>
        </div>
      </div>

    <!-- QR Code -->
      <div class="card qr-card">
        <h2>QR Code</h2>
        <p class="card-desc">Scan with v2rayNG, Hiddify, or any VLESS client</p>
        <p class="card-desc pq-notice hidden" id="pq-client-notice">PQ is enabled -- share link and QR require Xray-core 26.1.23+ compatible clients</p>
        <div class="qr-container">
          <div id="qr-loading" class="spinner"></div>
          <img id="qr-image" class="hidden" src="" alt="Client QR Code">
        </div>
      </div>
    </div>

    <div class="card pq-card hidden" id="pq-section">
      <h2>
        Post-Quantum Security
        <span class="badge pq-badge">PQ Enabled</span>
      </h2>
      <div class="detail-list">
        <div class="detail-row">
          <span class="detail-label">ML-DSA-65 Verify</span>
          <div class="detail-value">
            <code id="val-mldsa" class="truncate">-</code>
            <button class="copy-btn" data-target="val-mldsa" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
            </button>
          </div>
        </div>
        <div class="detail-row">
          <span class="detail-label">VLESS Encryption</span>
          <div class="detail-value">
            <code id="val-vlessenc" class="truncate">-</code>
            <button class="copy-btn" data-target="val-vlessenc" title="Copy">
              <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1"/></svg>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Actions -->
    <div class="actions-bar">
      <button class="btn btn-primary" id="btn-copy-link">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M10 13a5 5 0 007.54.54l3-3a5 5 0 00-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 00-7.54-.54l-3 3a5 5 0 007.07 7.07l1.71-1.71"/></svg>
        Copy Share Link
      </button>
      <button class="btn btn-secondary" id="btn-download">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        Download JSON
      </button>
      <button class="btn btn-danger" id="btn-regenerate">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><polyline points="1 20 1 14 7 14"/><path d="M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15"/></svg>
        Regenerate Keys
      </button>
    </div>

  </main>

  <div id="toast-container"></div>

  <div id="confirm-overlay" class="overlay hidden">
    <div class="confirm-dialog">
      <h3>Regenerate Keys?</h3>
      <p>This will invalidate all existing client configurations. The proxy container must be restarted to generate new keys.</p>
      <div class="confirm-actions">
        <button class="btn btn-secondary" id="confirm-cancel">Cancel</button>
        <button class="btn btn-danger" id="confirm-yes">Regenerate</button>
      </div>
    </div>
  </div>

  <script src="/js/app.js"></script>
</body>
</html>
